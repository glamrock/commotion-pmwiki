{"ts":1373575863568,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"/*  Copyright 2004 Patrick R. Michaud (pmichaud@pobox.com)\n    This file is part of PmWiki; you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published\n    by the Free Software Foundation; either version 2 of the License, or\n    (at your option) any later version.  See pmwiki.php for full details.\n\n    This file provides Javascript functions to support WYSIWYG-style\n    editing.  The concepts are borrowed from the editor used in Wikipedia,\n    but the code has been rewritten from scratch to integrate better with\n    PHP and PmWiki's codebase.  \n*/\n\nfunction insButton(mopen, mclose, mtext, mlabel, mkey) {\n  if (mkey > '') { mkey = 'accesskey=\"' + mkey + '\" ' }\n  document.write(\"<a tabindex='-1' \" + mkey + \"onclick=\\\"insMarkup('\"\n    + mopen + \"','\"\n    + mclose + \"','\"\n    + mtext + \"');\\\">\"\n    + mlabel + \"</a>\");\n}\n\nfunction insMarkup(mopen, mclose, mtext) {\n  var tarea = document.getElementById('text');\n  if (tarea.setSelectionRange > '') {\n    var p0 = tarea.selectionStart;\n    var p1 = tarea.selectionEnd;\n    var top = tarea.scrollTop;\n    var str = mtext;\n    var cur0 = p0 + mopen.length;\n    var cur1 = p0 + mopen.length + str.length;\n    while (p1 > p0 && tarea.value.substring(p1-1, p1) == ' ') p1--; \n    if (p1 > p0) {\n      str = tarea.value.substring(p0, p1);\n      cur0 = p0 + mopen.length + str.length + mclose.length;\n      cur1 = cur0;\n    }\n    tarea.value = tarea.value.substring(0,p0)\n      + mopen + str + mclose\n      + tarea.value.substring(p1);\n    tarea.focus();\n    tarea.selectionStart = cur0;\n    tarea.selectionEnd = cur1;\n    tarea.scrollTop = top;\n  } else if (document.selection) {\n    var str = document.selection.createRange().text;\n    tarea.focus();\n    range = document.selection.createRange()\n    if (str == '') {\n      range.text = mopen + mtext + mclose;\n      range.moveStart('character', -mclose.length - mtext.length );\n      range.moveEnd('character', -mclose.length );\n    } else {\n      if (str.charAt(str.length - 1) == \" \") {\n        mclose = mclose + \" \";\n        str = str.substr(0, str.length - 1);\n      }\n      range.text = mopen + str + mclose;\n    }\n    range.select();\n  } else { tarea.value += mopen + mtext + mclose; }\n  return;\n}\n"]],"start1":0,"start2":0,"length1":0,"length2":2253}]],"length":2253}
