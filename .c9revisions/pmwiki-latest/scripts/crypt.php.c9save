{"ts":1371754557655,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"<?php if (!defined('PmWiki')) exit();\n/*  Copyright 2002-2009 Patrick R. Michaud (pmichaud@pobox.com)\n    This file is part of PmWiki; you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published\n    by the Free Software Foundation; either version 2 of the License, or\n    (at your option) any later version.  See pmwiki.php for full details.\n\n    This script defines ?action=crypt, providing help for WikiAdministrators\n    to set up site-wide passwords in the installation.\n*/\n\nSDV($HandleActions['crypt'],'HandleCrypt');\nSDV($ActionTitleFmt['crypt'],'| $[Password encryption]');\n\nfunction HandleCrypt($pagename, $auth='read') {\n  global $ScriptUrl,$HTMLStartFmt,$HTMLEndFmt;\n  PrintFmt($pagename,$HTMLStartFmt);\n  $passwd = stripmagic(@$_POST[\"passwd\"]);\n  echo FmtPageName(\n    \"<form action='{\\$ScriptUrl}' method='POST'><p>\n      Enter password to encrypt: \n      <input type='text' name='passwd' value='\"\n      . PHSC($passwd, ENT_QUOTES) .\"' />\n      <input type='submit' />\n      <input type='hidden' name='n' value='{\\$FullName}' />\n      <input type='hidden' name='action' value='crypt' /></p></form>\",\n    $pagename);\n  if ($passwd) { \n    $crypt = crypt($passwd);\n    echo \"<p class='vspace'>Encrypted password = $crypt</p>\"; \n    echo \"<p class='vspace'>To set a site-wide password, insert the line below\n      in your <i>config.php</i> file, <br />replacing <tt>'type'</tt> with\n      one of <tt>'admin'</tt>, <tt>'read'</tt>, <tt>'edit'</tt>,\n      or <tt>'attr'</tt>.  <br />See <a \n      href='$ScriptUrl?n=PmWiki.PasswordsAdmin'>PasswordsAdmin</a> for more\n      details.</p>\n      <pre class='vspace'>  \\$DefaultPasswords['type']='$crypt';</pre>\";\n  }\n  PrintFmt($pagename,$HTMLEndFmt);\n}\n\n"]],"start1":0,"start2":0,"length1":0,"length2":1757}]],"length":1757}
